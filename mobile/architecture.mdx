---
title: 'Mobile Architecture'
description: 'Technical architecture of the Maneged Flutter app'
icon: 'sitemap'
---

## Overview

The Maneged Flutter app follows a clean, layered architecture pattern:

```mermaid
graph TB
    UI[ğŸ¨ Presentation Layer<br/>Widgets & Screens]
    BL[âš™ï¸ Business Logic Layer<br/>Providers & Services]
    Data[ğŸ’¾ Data Layer<br/>Isar DB & API Client]
    Local[(ğŸ“¦ Isar Database<br/>Local Storage)]
    Remote[ğŸŒ Remote API<br/>REST + WebSocket]
    
    UI --> BL
    BL --> Data
    Data --> Local
    Data --> Remote
    Remote -.Real-time Updates.-> BL
    BL -.State Changes.-> UI
    
    style UI fill:#E3F2FD
    style BL fill:#BBDEFB
    style Data fill:#90CAF9
    style Local fill:#64B5F6
    style Remote fill:#42A5F5
```

## Architecture Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Presentation Layer (UI)         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Widgets  â”‚  â”‚  State (Provider)â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Business Logic Layer           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Services â”‚  â”‚   Use Cases     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Data Layer                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Isar DB â”‚  â”‚  Appwrite API   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Core Components

### State Management (Provider)

```dart
class ChatProvider extends ChangeNotifier {
  List<Message> _messages = [];
  
  Future<void> sendMessage(String text) async {
    // Update local state
    _messages.add(Message(text: text));
    notifyListeners();
    
    // Sync to server
    await api.sendMessage(text);
  }
}
```

### Local Database (Isar)

```dart
@collection
class Message {
  Id id = Isar.autoIncrement;
  String? messageId;
  String? text;
  String? senderId;
  DateTime? createdAt;
}
```

### WebSocket Service

```dart
class WebSocketService {
  void connect() {
    _channel = WebSocketChannel.connect(
      Uri.parse('ws://localhost:3000?token=$token'),
    );
    _channel!.stream.listen(_handleMessage);
  }
}
```

## Feature Modules

Each feature is self-contained:

```
features/chat/
â”œâ”€â”€ models/          # Data models
â”œâ”€â”€ screens/         # UI screens
â”œâ”€â”€ widgets/         # Reusable widgets
â”œâ”€â”€ providers/       # State management
â””â”€â”€ services/        # Business logic
```

## Data Flow

### Message Sending

```
1. User types message
2. Local Isar DB updated (instant UI update)
3. WebSocket sends to server
4. Server broadcasts to recipients
5. Local DB updated with server confirmation
```

### Real-time Updates

```
1. Server sends WebSocket event
2. WebSocket service receives
3. Local Isar DB updated
4. Provider notifies listeners
5. UI rebuilds automatically
```

## Offline Support

- All data cached locally in Isar
- Queue pending actions
- Auto-retry with exponential backoff
- Sync when connection restored

## Next Steps

<CardGroup cols={2}>
  <Card
    title="Features"
    icon="list"
    href="/mobile/features"
  >
    Explore app features
  </Card>
  <Card
    title="Backend API"
    icon="server"
    href="/backend/introduction"
  >
    Backend integration
  </Card>
</CardGroup>
